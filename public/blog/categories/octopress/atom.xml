<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: octopress | Reza Jatnika]]></title>
  <link href="http://reza.re/blog/categories/octopress/atom.xml" rel="self"/>
  <link href="http://reza.re/"/>
  <updated>2013-06-15T05:59:51+07:00</updated>
  <id>http://reza.re/</id>
  <author>
    <name><![CDATA[Reza Jatnika]]></name>
    <email><![CDATA[reza@reza.re]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Deploying Octopress/Jekyll on AppFog]]></title>
    <link href="http://reza.re/blog/2013/deploying-octopress-slash-jekyll-on-appfog/"/>
    <updated>2013-06-15T04:55:00+07:00</updated>
    <id>http://reza.re/blog/2013/deploying-octopress-slash-jekyll-on-appfog</id>
    <content type="html"><![CDATA[<p>Deploying Jekyll or Octopress based website to Heroku is really easy and simple, because Heroku use git for source code management. Heroku will create automatically our server based on our type of application, but we can&rsquo;t choose server location. With AppFog we can choose nearest server from our location. I live in Indonesia, so the nearest infrastucture is AWS Singapore. We can have very little response time compared to Heroku.</p>

<h2>Preparation</h2>

<p>Deploying to AppFog is not as easy as deploying to Heroku. We need to configure Octopress. Before that, lets install af gem. It&rsquo;s similar to heroku gem.</p>

<p><code>
$ gem install af
</code></p>

<p>After installing af gem, go to our Octopress directory. Login to AppFog by running the following command:</p>

<p><code>
$ af login
</code></p>

<p>Create an <code>app.rb</code> file to handle <code>SinatraStaticServer</code> class.</p>

<p>{% codeblock app.rb lang:ruby %}
require &lsquo;bundler/setup&rsquo;
require &lsquo;sinatra&rsquo;</p>

<h1>The project root directory</h1>

<p>$root = ::File.dirname(<strong>FILE</strong>)</p>

<p>  get(/.+/) do</p>

<pre><code>send_sinatra_file(request.path) {404}
</code></pre>

<p>  end</p>

<p>  not_found do</p>

<pre><code>send_file(File.join(File.dirname(__FILE__), 'public', '404.html'), {:status =&gt; 404})
</code></pre>

<p>  end</p>

<p>  def send_sinatra_file(path, &amp;missing_file_block)</p>

<pre><code>file_path = File.join(File.dirname(__FILE__), 'public',  path)
file_path = File.join(file_path, 'index.html') unless file_path =~ /\.[a-z]+$/i
File.exist?(file_path) ? send_file(file_path) : missing_file_block.call
</code></pre>

<p>  end
{% endcodeblock %}</p>

<p>Create <code>.afignore</code>, it&rsquo;s similar to <code>.gitignore</code> in git.</p>

<p>{% codeblock .afignore %}</p>

<h1>Local config</h1>

<p>config.ru</p>

<p>.sass-cache/
.gist-cache/
.pygments-cache/</p>

<p>.themes/</p>

<p>.gitignore
.gitattributes
{% endcodeblock %}</p>

<p>We include <code>config.ru</code> because we already have <code>app.rb</code> to handle Sinatra.</p>

<h2>Deploying</h2>

<p>We can create new AppFog app by using website or directly from command line.</p>

<p><code>
$ af push --runtime ruby193
</code></p>

<p>Choose Sinatra application not Rack application. Save the configuration file, it&rsquo;s looks like this.</p>

<h2>{% codeblock manifest.yml lang:yaml %}</h2>

<p>applications:
  .:</p>

<pre><code>name: rezare
framework:
  name: sinatra
  info:
    mem: 128M
    description: Sinatra Application
    exec: 
infra: ap-aws
url: ${name}.${target-base}
mem: 512M
instances: 1
</code></pre>

<p>{% endcodeblock %}</p>

<p>To update our application run:</p>

<p><code>
$ git add .
$ git commit -m "Site updated"
$ af update
</code></p>

<h2>Conclusion</h2>

<p>Using AppFog for deploying Octopress is slightly different than Heroku, but it&rsquo;s offer better response time. AppFog do not use source code management, but we can use GitHub or bitbucket to store our website code. And one more thing, we can not use custom domain on free plans.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Improving Octopress Performance]]></title>
    <link href="http://reza.re/blog/2013/improving-octopress-performance/"/>
    <updated>2013-06-13T12:08:00+07:00</updated>
    <id>http://reza.re/blog/2013/improving-octopress-performance</id>
    <content type="html"><![CDATA[<p>This is how I improving octopress website based, it&rsquo;s covers Cloudflare DNS/CDN management and configuration of heroku and sinatra.</p>

<h2>DNS and CDN Management</h2>

<p>CloudFlare is more than just a DNS, their service includes a CDN, page acceleration, security checking, DDOS protection, and more. However, you can switch all that off and just use their DNS. They delivered marginally the best performance. In terms of pricing, if you don’t need SSL, it’s free; if you do need SSL, then your first site is $240 per year, subsequent sites $60 per year.</p>

<p>My example sites:</p>

<ul>
<li><a href="http://reza.re">reza.re</a> &ndash; Cloudflare + CDN</li>
<li><a href="http://direct.reza.re">direct.reza.re</a> &ndash; Cloudflare</li>
</ul>


<h2>Heroku and Sinatra</h2>

<p> The default configuration for Octopress and Heroku is to use Sinatra, which in turn means that Heroku will serve your traffic using Webrick. The result is one Heroku instance running one web server. If you use Unicorn, you can get multiple instances running within it; in the configuration described below, this results in four times the capacity.</p>

<p>Add Unicorn to the <code>Gemfile</code> outside of the development group:</p>

<p>{% codeblock Gemfile lang:ruby %}
source &ldquo;<a href="http://rubygems.org">http://rubygems.org</a>&rdquo;</p>

<p>group :development do
  # all default gems
end</p>

<p>gem &lsquo;sinatra&rsquo;, &lsquo;~> 1.4.2&rsquo;
gem &lsquo;unicorn&rsquo;</p>

<p>{% endcodeblock %}</p>

<p>Add a <code>unicorn.rb</code> file in the root directory of your application:</p>

<p>{% codeblock unicorn.rb lang:ruby %}
worker_processes 4
timeout 30
preload_app true
{% endcodeblock %}</p>

<p>Add a <code>Procfile</code> file in the root directory of your application:</p>

<p>{% codeblock Procfile lang:ruby %}
web: bundle exec unicorn -p $PORT -c ./unicorn.rb
{% endcodeblock %}</p>

<p>That&rsquo;s it. You can test your website performance score using <a href="https://developers.google.com/speed/pagespeed/insights#">Google PageSpeed</a> and see suggestion summary.</p>
]]></content>
  </entry>
  
</feed>
